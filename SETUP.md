# ポケモンカード販売管理システム セットアップガイド

## 1. Google Apps Script プロジェクトの作成

### 1.1 新しいスプレッドシートを作成
1. [Google Sheets](https://sheets.google.com) にアクセス
2. 「空白のスプレッドシート」を作成
3. スプレッドシート名を「ポケモンカード販売管理システム」に変更

### 1.2 Apps Script プロジェクトを作成
1. スプレッドシートで「拡張機能」→「Apps Script」を選択
2. プロジェクト名を「PokemonCardManagement」に変更
3. 既存の `Code.gs` を削除

### 1.3 コードファイルをアップロード
1. このリポジトリの `src/Code.js` の内容をコピー
2. Apps Script エディタで新しいファイルを作成し、`Code.gs` として保存
3. コードを貼り付け
4. `appsscript.json` の内容も設定に反映

## 2. 初期設定

### 2.1 スプレッドシートの初期化
1. スプレッドシートに戻る
2. メニューバーに「SalesOps」が表示されることを確認
3. 「SalesOps」→「新規顧客作成」を実行してシートを初期化

### 2.2 参照リストの設定
以下のシートに参照データを設定：

#### 参照_リスト シート
- **集客先**: Instagram, Facebook, WhatsApp, TikTok, Other
- **顧客フラグ**: ストリーマー, カードショップ, リセラー, 卸
- **支払い方法**: Wise, PayPal, Other
- **注文ステータス**: 支払い前, 支払い完了, 仕入れ完了, 発送済, 追跡番号送付済, 到着, キャンセル
- **在庫ステータス**: 在庫, 予約, 発注中, 出庫済, 欠品
- **配送会社**: Japan Post, DHL, FedEx, UPS, Other
- **還元率**: 0%, 8%, 10%

## 3. 基本機能のテスト

### 3.1 顧客作成テスト
1. 「SalesOps」→「新規顧客作成」
2. 顧客IDが自動生成されることを確認
3. 顧客情報を入力

### 3.2 注文作成テスト
1. 「SalesOps」→「新規注文作成」
2. 顧客を選択
3. 注文IDが自動生成されることを確認
4. 注文ヘッダーと明細テンプレートが作成されることを確認

## 4. 高度な機能の設定

### 4.1 決済CSV取込の設定
- PayPal CSV の列マッピング設定
- Wise CSV の列マッピング設定
- 決済手数料レートの設定

### 4.2 Looker Studio 連携
1. 「Export_Looker」シートの設定
2. Looker Studio でのデータソース接続
3. 自動更新トリガーの設定

## 5. 運用開始

### 5.1 データ入力
1. 既存顧客データの移行
2. 在庫データの登録
3. 過去の注文データの移行（必要に応じて）

### 5.2 定期メンテナンス
1. 日次バックアップの設定
2. 顧客集計の定期更新
3. Looker Export の定期更新

## トラブルシューティング

### よくある問題
1. **メニューが表示されない**: ページを再読み込みしてから Apps Script を実行
2. **シートが作成されない**: 権限を確認し、手動でシートを作成
3. **ID生成エラー**: 設定_定数シートの連番カウンタを確認

### サポート
問題が発生した場合は、以下を確認してください：
- Apps Script の実行ログ
- スプレッドシートの権限設定
- ブラウザのコンソールエラー